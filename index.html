<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LittleBrett Game</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { width: 100%; height: 100%; background: #82d0f7; overflow: hidden; font-family: sans-serif; }

    canvas {
      display: block;
      background: url('bg.png') no-repeat center;
      background-size: cover;
    }

    #startBtn {
      position: absolute;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: none;
      border: none;
      cursor: pointer;
      z-index: 99;
    }

    #startBtn img {
      width: 150px;
    }
  </style>
</head>
<body>
  <button id="startBtn"><img src="btn_start.png" alt="Start Game"></button>
  <canvas id="gameCanvas" width="360" height="640"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    const brett = {
      x: 150,
      y: 500,
      width: 50,
      height: 50,
      vy: 0,
      jumpPower: -12,
      gravity: 0.6,
      imgIdle: new Image(),
      imgJump: new Image(),
      imgFall: new Image(),
      imgHappy: new Image(),
      imgDown: new Image(),
      sprite: null,
    };

    brett.imgIdle.src = "brett_idle.png";
    brett.imgJump.src = "brett_jump.png";
    brett.imgFall.src = "brett_fall.png";
    brett.imgHappy.src = "brett_happy.png";
    brett.imgDown.src = "brett_down.png";
    brett.sprite = brett.imgIdle;

    const platformImg = new Image();
    platformImg.src = "platform_green.png";

    const coins = [
      { img: new Image(), x: 80, y: 200 },
      { img: new Image(), x: 220, y: 350 },
      { img: new Image(), x: 150, y: 500 },
    ];
    coins[0].img.src = "btc.png";
    coins[1].img.src = "eth.png";
    coins[2].img.src = "coin.png";

    const platforms = [];
    const platformCount = 50;

    function generatePlatforms() {
      for (let i = 0; i < platformCount; i++) {
        platforms.push({
          x: Math.random() * (canvas.width - 70),
          y: i * 120,
        });
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // draw platforms
      platforms.forEach(p => {
        ctx.drawImage(platformImg, p.x, p.y, 70, 20);
      });

      // draw coins
      coins.forEach(c => {
        ctx.drawImage(c.img, c.x, c.y, 30, 30);
      });

      // draw Brett
      ctx.drawImage(brett.sprite, brett.x, brett.y, brett.width, brett.height);
    }

    function update() {
      brett.vy += brett.gravity;
      brett.y += brett.vy;

      // collision
      platforms.forEach(p => {
        if (
          brett.x + brett.width > p.x &&
          brett.x < p.x + 70 &&
          brett.y + brett.height > p.y &&
          brett.y + brett.height < p.y + 10 &&
          brett.vy >= 0
        ) {
          brett.vy = brett.jumpPower;
        }
      });

      // scroll up
      if (brett.y < canvas.height / 2) {
        const dy = canvas.height / 2 - brett.y;
        brett.y = canvas.height / 2;
        platforms.forEach(p => p.y += dy);
        coins.forEach(c => c.y += dy);
      }

      // lose condition
      if (brett.y > canvas.height) {
        brett.sprite = brett.imgDown;
        draw();
        return cancelAnimationFrame(gameLoopId);
      }

      // win condition
      const highestPlatform = platforms[platforms.length - 1];
      if (highestPlatform && highestPlatform.y > canvas.height + 100) {
        brett.sprite = brett.imgHappy;
        draw();
        return cancelAnimationFrame(gameLoopId);
      }

      if (brett.vy < 0) brett.sprite = brett.imgJump;
      else if (brett.vy > 5) brett.sprite = brett.imgFall;
      else brett.sprite = brett.imgIdle;
    }

    let gameLoopId;
    function gameLoop() {
      update();
      draw();
      gameLoopId = requestAnimationFrame(gameLoop);
    }

    function startGame() {
      generatePlatforms();
      document.getElementById("startBtn").style.display = "none";
      gameLoop();
    }

    window.addEventListener("keydown", e => {
      if (e.key === "ArrowLeft") brett.x -= 20;
      if (e.key === "ArrowRight") brett.x += 20;
    });

    document.getElementById("startBtn").addEventListener("click", startGame);
  </script>
</body>
</html>
